<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate optimal design parameters for a single-stage gold-standard design"><title>Calculate optimal design parameters for a single-stage gold-standard design — optimize_design_onestage • OptimalGoldstandardDesigns</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate optimal design parameters for a single-stage gold-standard design — optimize_design_onestage"><meta property="og:description" content="Calculate optimal design parameters for a single-stage gold-standard design"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">OptimalGoldstandardDesigns</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Comparison_with_other_software.html">Comparison_with_other_software</a>
    <a class="dropdown-item" href="../articles/Design_adaptations_at_interim.html">Design_adaptations_at_interim</a>
    <a class="dropdown-item" href="../articles/Introduction.html">Introduction</a>
    <a class="dropdown-item" href="../articles/mathematical_details.html">Mathematical details</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate optimal design parameters for a single-stage gold-standard design</h1>
      
      <div class="d-none name"><code>optimize_design_onestage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate optimal design parameters for a single-stage gold-standard design</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">optimize_design_onestage</span><span class="op">(</span>
  cP1 <span class="op">=</span> <span class="cn">NULL</span>,
  cC1 <span class="op">=</span> <span class="cn">NULL</span>,
  alpha <span class="op">=</span> <span class="fl">0.025</span>,
  beta <span class="op">=</span> <span class="fl">0.2</span>,
  alternative_TP <span class="op">=</span> <span class="fl">0.4</span>,
  alternative_TC <span class="op">=</span> <span class="fl">0</span>,
  Delta <span class="op">=</span> <span class="fl">0.2</span>,
  varT <span class="op">=</span> <span class="fl">1</span>,
  varP <span class="op">=</span> <span class="fl">1</span>,
  varC <span class="op">=</span> <span class="fl">1</span>,
  round_n <span class="op">=</span> <span class="cn">TRUE</span>,
  kappa <span class="op">=</span> <span class="fl">0</span>,
  objective <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="va">kappa</span> <span class="op">*</span> <span class="va">n</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"P"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
  inner_tol_objective <span class="op">=</span> <span class="fl">1e-07</span>,
  mvnorm_algorithm <span class="op">=</span> <span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/algorithms.html" class="external-link">Miwa</a></span><span class="op">(</span>steps <span class="op">=</span> <span class="fl">4097</span>, checkCorr <span class="op">=</span> <span class="cn">FALSE</span>, maxval <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>,
  nloptr_x0 <span class="op">=</span> <span class="cn">NULL</span>,
  nloptr_lb <span class="op">=</span> <span class="cn">NULL</span>,
  nloptr_ub <span class="op">=</span> <span class="cn">NULL</span>,
  nloptr_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>algorithm <span class="op">=</span> <span class="st">"NLOPT_LN_SBPLX"</span>, ftol_rel <span class="op">=</span> <span class="fl">1e-09</span>, xtol_abs <span class="op">=</span> <span class="fl">1e-08</span>,
    xtol_rel <span class="op">=</span> <span class="fl">1e-07</span>, maxeval <span class="op">=</span> <span class="fl">1000</span>, print_level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  print_progress <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>cP1</dt>
<dd><p>(numeric) allocation ratio nP1 / nT1. Parameter to be optimized if left unspecified.</p></dd>
<dt>cC1</dt>
<dd><p>(numeric) allocation ratio nC1 / nT1. Parameter to be optimized if left unspecified.</p></dd>
<dt>alpha</dt>
<dd><p>type I error rate.</p></dd>
<dt>beta</dt>
<dd><p>type II error rate.</p></dd>
<dt>alternative_TP</dt>
<dd><p>assumed difference between T and P under H1. Positive values favor T.</p></dd>
<dt>alternative_TC</dt>
<dd><p>assumed difference between T and C under H1. Positive values favor T.</p></dd>
<dt>Delta</dt>
<dd><p>non-inferiority margin for the test \(X_T - X_C \leq - \Delta\) vs.
\(X_T - X_C &gt; - \Delta\).</p></dd>
<dt>varT</dt>
<dd><p>variance of treatment group.</p></dd>
<dt>varP</dt>
<dd><p>variance of placebo group.</p></dd>
<dt>varC</dt>
<dd><p>variance of control group.</p></dd>
<dt>round_n</dt>
<dd><p>(logical) if TRUE, a design with integer valued sample sizes is returned.</p></dd>
<dt>kappa</dt>
<dd><p>(numeric) penalty factor for placebo patients in the default objective function.</p></dd>
<dt>objective</dt>
<dd><p>(expression) objective criterion.</p></dd>
<dt>inner_tol_objective</dt>
<dd><p>(numeric) used to determine the tolerances for integrals and nuisance optimization problems
inside the objective function.</p></dd>
<dt>mvnorm_algorithm</dt>
<dd><p>algorithm for multivariate integration passed to <code><a href="https://rdrr.io/pkg/mvtnorm/man/pmvnorm.html" class="external-link">pmvnorm</a></code>.</p></dd>
<dt>nloptr_x0</dt>
<dd><p>(numeric vector) starting point for optimization.</p></dd>
<dt>nloptr_lb</dt>
<dd><p>(numeric vector) lower bound box for box constrained optimization.</p></dd>
<dt>nloptr_ub</dt>
<dd><p>(numeric vector) upper bound box for box constrained optimization.</p></dd>
<dt>nloptr_opts</dt>
<dd><p>(list) nloptr options. See <code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr</a></code>.</p></dd>
<dt>print_progress</dt>
<dd><p>(logical) controls whether optimization progress should be visualized during the calculation.</p></dd>
<dt>...</dt>
<dd><p>additional arguments passed along.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Design object (a list) with optimized design parameters.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates optimal design parameters for a two-stage three-arm gold-standard
non-inferiority trial. Run <code><a href="../articles/mathematical_details.html">vignette("mathematical_details", package = "OptimalGoldstandardDesigns")</a></code>
to see details about the test statistics and testing procedure corresponding to this design.</p>

<p>Parameters which can be optimized are the allocation ratios for all groups and stages and the
futility and efficacy boundaries of the first stage. The allocation ratios are
cT2 = nT2 / nT1, cP1 = nP1 / nT1,
cP2 = nP2 / nT1, cC1 = nC1 / nT1 and cC2 = nC2 / nT1. Here, nT1 denotes the sample size
of the treatment group in the first stage, nP2 the sample size of the placebo group in the
second stage, etc. The first stage efficacy boundaries are bTP1e for the treatment vs
placebo testing problem, and bTC1e for the treatment vs control non-inferiority testing
problem. The futility boundaries are denoted by bTP1f and bTC1f.</p>
<p>If these parameters are left unspecified or set to NULL, they will be included into the
optimization process, otherwise they will be considered boundary constraints.
You may also supply quoted expressions as arguments for these
parameters to solve a constrained optimization problem. For example, you can supply
<code>cT2 = 1, cP2 = quote(cP1), cC2 = quote(cC1)</code> to ensure that the first and second
stage allocation ratios are equal.</p>

<p>The design is optimized with respect to the objective criterion given by the parameter
<code>objective</code>. By default, ...</p>
<p>Designs are calculated to fulfill the following constraints: the family-wise type I error
rate is controlled at <code>alpha</code> under any combination of the two null hypotheses
<code>muT - muP = 0</code> and <code>muT - muC + Delta = 0</code>.
The power to reject both hypothesis given both alternative
hypotheses <code>muT - muP = alternative_TP</code> and <code>muT - muC + Delta = alternative_TC + Delta</code>
is at least <code>1 - beta</code>. Variances are assumed to be given by <code>varT, varP</code> and <code>varC</code>.</p>
<p>If <code>binding_futility</code> is <code>TRUE</code>, type I error recycling is used.
If <code>always_both_futility_tests</code> is <code>TRUE</code>, it is assumed that futility tests for both
hypotheses are performed at interim, regardless of whether the treatment vs placebo null hypothesis
was successfully rejected. If <code>always_both_futility_tests</code> is <code>FALSE</code>, the futility
test for the treatment vs. control testing problem only needs to be done if the null for the
treatment vs. placebo testing problem was rejected in the first stage.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">D</span> <span class="op">&lt;-</span> <span class="fu"><a href="optimize_design_twostage.html">optimize_design_twostage</a></span><span class="op">(</span>nloptr_opts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxeval <span class="op">=</span> <span class="fl">1</span>, algorithm <span class="op">=</span> <span class="st">"NLOPT_LN_SBPLX"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  iteration: 1/1                                                                      cT2 &lt;- x[1L] cP1 &lt;- x[2L] cP2 &lt;- x[3L] cC1 &lt;- x[4L] cC2 &lt;- x[5L] bTP1e &lt;- x[6L] bTP1f &lt;- x[7L] bTC1e &lt;- x[8L] bTC1f &lt;- x[9L]      x = c(1.000000, 0.250000, 0.250000, 1.000000, 1.000000, 2.105099, 0.000000, 2.270933, 0.000000)       f(x) = 815.7735                                                              iteration: 2/1                                                                      cT2 &lt;- x[1L] cP1 &lt;- x[2L] cP2 &lt;- x[3L] cC1 &lt;- x[4L] cC2 &lt;- x[5L] bTP1e &lt;- x[6L] bTP1f &lt;- x[7L] bTC1e &lt;- x[8L] bTC1f &lt;- x[9L]      x = c(1.000000, 0.250000, 0.250000, 1.000000, 1.000000, 2.105099, 0.000000, 2.270933, 0.000000)       f(x) = 815.7735                                                              iteration: 3/1                                                                      cT2 &lt;- x[1L] cP1 &lt;- x[2L] cP2 &lt;- x[3L] cC1 &lt;- x[4L] cC2 &lt;- x[5L] bTP1e &lt;- x[6L] bTP1f &lt;- x[7L] bTC1e &lt;- x[8L] bTC1f &lt;- x[9L]      x = c(1.000000, 0.250000, 0.250000, 1.000000, 1.000000, 2.105099, 0.000000, 2.270933, 0.000000)       f(x) = 815.7735                                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Optimization finished. Calculating final design with greater accuracy...</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jan Meis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer></div>

  

  

  </body></html>

